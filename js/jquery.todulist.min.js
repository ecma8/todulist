(function(a){a.fn.extend({toDuList:function(b){return this.each(function(){var n=b.title?b.title:"id,name,set";var f=b.box?b.box:"";var k=b.flag?b.flag:1;var o=b.attrArr?b.attrArr:"array";var s=b.caozuo?b.caozuo:"删除";var r=a("<table></table>");var j=a("<tr></tr>");var e=n.split(",");var g=a(this);var m=[];var p=g.selector.replace(/\#/,"")+"_del";var h=g.selector.replace(/\#/,"")+"_id";for(var d=0;d<e.length;d++){var c=a("<th>"+e[d]+"</th>");j.append(c)}r.append(j);f.append(r);var l=0;function q(t){var u=a("<tr></tr>");var w=a("<td class="+h+">"+t.id+"</td>");var i=a("<td>"+t.name+"</td>");var v=a("<td><a href=javascript:; class="+p+">"+t.caozuo+"</a></td>");u.append(w).append(i).append(v);r.append(u)}a(this).on("change",function(){num=0;if(k==1){num=0;var t=a(this).children(":selected").val();var i=a(this).children(":selected").text();if(f.find("tr").size()==1){l++;q({id:l,name:i,caozuo:s});m.push(t);console.log(m);console.log(a(this));a(this).attr(o,m)}else{r.find("tr").eq(1).find("td").eq(1).text(i);m=[];m.push(t);a(this).attr(o,m)}}else{if(k==2){var t=a(this).children(":selected").val();var i=a(this).children(":selected").text();if(m.indexOf(t)>-1){return false}else{l++;q({id:l,name:i,caozuo:s});m.push(t);a(this).attr(o,m)}}}});f.on("click","."+p,function(){var t=a("."+p).index(this);l--;a("."+p).parent().parent().parent().find("tr").eq(t+1).remove();m.splice(t,1);g.attr(o,m);for(var u=0;u<a("."+p).size();u++){a("."+h).eq(u).text(u+1)}})})}})})(jQuery);